# Docker Compose cho Seq Centralized Logging
# 
# Cách sử dụng:
# 1. Copy file này vào project root hoặc merge vào docker-compose.yml hiện có
# 2. Chạy: docker-compose -f docker-compose.seq.yml up -d
# 3. Truy cập Seq UI: http://localhost:5341
# 4. Cấu hình .env: SEQ_SERVER_URL=http://localhost:5341

version: '3.8'

services:
  # Seq Centralized Logging Server
  seq:
    image: datalust/seq:latest
    container_name: seq-logging
    ports:
      - "5341:80"
    environment:
      - ACCEPT_EULA=Y
      # Optional: Set base URI nếu deploy behind proxy
      # - BASE_URI=https://seq.yourdomain.com
    volumes:
      - seq-data:/data
    restart: unless-stopped
    networks:
      - logging-network
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s
    labels:
      - "com.seq.description=Seq centralized logging server"
      - "com.seq.version=latest"

volumes:
  seq-data:
    driver: local
    driver_opts:
      type: none
      o: bind
      # Thay đổi path này để lưu data của Seq
      device: ./seq-data

networks:
  logging-network:
    driver: bridge

# Optional: Seq Ingestion API nếu cần expose riêng
# services:
#   seq-ingestion:
#     image: datalust/seq:latest
#     container_name: seq-ingestion
#     ports:
#       - "5342:5341"
#     environment:
#       - ACCEPT_EULA=Y
#     volumes:
#       - seq-data:/data
#     networks:
#       - logging-network

